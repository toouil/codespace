import{j as s,r as m,Y as w,a as y}from"./app-xtGLZL-7.js";import{A as k}from"./AuthenticatedLayout-BWzqmOdx.js";import{L as I}from"./Loader-Br331SDq.js";import{u as q}from"./useApi-DH0F1Rzl.js";import{n as E}from"./Notify-Dlq59V6X.js";import"./index-BIcDevOB.js";function L({assignment:o,timeOver:t,setCheckedAnswer:c}){const{question:n,code:a,answers:r}=o,l=({target:{checked:e}},i)=>{e&&c(i)};return s.jsxs("div",{className:"assignment_container",children:[s.jsx("div",{className:"assignment_question",children:s.jsx("h2",{className:"assignment_question_text",children:n})}),a&&s.jsx("div",{className:"assignment_code",children:a}),s.jsx("div",{className:"assignment_answers",children:r&&r.map(({answer:e,id:i})=>s.jsx("div",{className:"assignment_answer",children:s.jsxs("label",{htmlFor:i,className:"content_center",children:[s.jsx("input",{type:"radio",onChange:_=>l(_,i),id:i,name:"assignment answer",disabled:t}),e]})},i))})]})}function O(o){const[t,c]=m.useState(!1),[n,a]=m.useState(null),r=m.useRef(),l=()=>{clearInterval(r.current)},e=()=>{c(!1),r.current=setInterval(()=>{a(h=>h-1)},1e3)},i=()=>{l(),a(o),e()},_=h=>{const u=x=>x<10?`0${x}`:x;let p=u(Math.floor(h/60)),g=u(h%60);return`${p}:${g}`};return m.useEffect(()=>{n<=0&&(c(!0),l())},[n]),{countdown:n,formattedCountdown:_(n),isTimeOut:t,startCountdown:e,stopCountdown:l,resetCountdown:i}}function R({results:o}){const{passed:t,badge:c,name:n,message:a,score:r,oldscore:l,action:e}=o==null?void 0:o.data;return s.jsxs(s.Fragment,{children:[s.jsx(w,{title:"Score result - "+r+" points"}),s.jsx("main",{className:"score_results_container content_center",children:s.jsxs("div",{className:"score_results",children:[s.jsx("div",{className:"score_results_header",children:s.jsx("h1",{className:"score_results_header_title",children:"Score result"})}),s.jsxs("div",{className:"score_results_content",children:[s.jsx("div",{className:"score_results_content_passed",children:t?s.jsx("h3",{className:"success",children:"You passed the test"}):s.jsx("h3",{className:"failed",children:"Sorry ... you didn't pass the test"})}),s.jsx("div",{className:"score_results_content_score",children:s.jsxs("h1",{children:["You got",s.jsx("span",{className:"score_points",children:r}),"points"]})}),!!t&&e!="none"&&s.jsxs("div",{className:"score_results_content_badge",children:[s.jsx("div",{className:"bagde_display",children:s.jsx("img",{src:c,alt:`${n}_badge`})}),s.jsxs("div",{className:"bagde_title",children:["You've earned a",s.jsx("span",{className:"bold_text",children:n}),"'s badge"]})]}),s.jsx("div",{className:"score_results_message",children:e=="update"?s.jsxs("p",{children:[a," from",s.jsx("span",{className:"score_points",children:l}),"to",s.jsx("span",{className:"score_points",children:r}),"points`"]}):s.jsx("p",{children:a})})]}),s.jsx("div",{className:"score_results_footer",children:s.jsx(y,{href:"/categories",className:"back_link content_center",children:"Back to categories"})})]})})]})}function Q({auth:o,assignments:t,category:c}){const{formattedCountdown:n,isTimeOut:a,stopCountdown:r,resetCountdown:l}=O(60),{data:e,setData:i,postRequest:_,success:h,response:u,fetching:p}=q({dataTemplate:{category:c,answers:[]},onSuccess:j=>{(j==null?void 0:j.status)!=200&&E("Something went wrong .. please try later")}}),[g,x]=m.useState(null),[d,b]=m.useState(0),[N,f]=m.useState(null),[C,S]=m.useState(!1),v=d>=t.length-1,A=j=>{j.preventDefault(),i("answers",[...e==null?void 0:e.answers,N]),r(),f(null),v?$():b(d+1)},$=()=>{S(!0),_(route("scores.store"),{answers:[...e==null?void 0:e.answers,N]})};return m.useEffect(()=>{x(t[d]),l()},[d]),h&&(u==null?void 0:u.status)==200?s.jsx(R,{results:u}):s.jsxs(k,{user:o.user,children:[s.jsx(w,{title:`${c}'s assignments`}),s.jsxs("div",{className:"assignments_page",children:[s.jsxs("form",{className:"assignments_container container",children:[s.jsx("div",{className:"assignments_header content_center",children:s.jsx("h3",{className:"assignments_category",children:`${c}'s assignment`})}),s.jsx("div",{className:"divider_x"}),s.jsx("div",{className:"assignments_content",children:g&&s.jsx(L,{assignment:g,setCheckedAnswer:f,timeOver:a},d)}),s.jsx("div",{className:"assignments_progress_bar",children:t&&d>=0&&s.jsx("div",{className:"assignments_progress_bar_inner",style:{"--width":`${(d+1)/t.length*100}%`}})}),s.jsxs("div",{className:"assignments_footer",children:[s.jsxs("div",{className:"assignments_footer_left_part content_center",children:[s.jsx("div",{className:"assignments_count",children:t&&d>=0&&`Q${d+1} / ${t.length}`}),s.jsx("div",{className:"assignments_timer",children:n})]}),s.jsx("div",{className:"assignments_footer_right_part",children:s.jsx("div",{className:"next_assignments",children:s.jsx("button",{className:"next_assignment_btn content_center",disabled:!((N||a)&&!C),type:"button",onClick:A,children:v?"submit":"next"})})})]})]}),p&&s.jsx(I,{})]})]})}export{Q as default};
